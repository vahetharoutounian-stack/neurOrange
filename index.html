<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<meta name="color-scheme" content="dark" />
<meta name="theme-color" content="#000000" />
<title>neurOrange ‚Äî press üçä to begin</title>
<style>
  :root{
    --bergamot:#FFA64D; --pure:#FFA500; --nick:#FF6600; --after:#F9751F;
    --gap-deg:3; --outer-thick-mult:2.2; --emoji-font:18px; --glow:0 0 10px #000, 0 0 18px #000;
  }
  *{box-sizing:border-box}
  html,body{margin:0;min-height:100%;background:#000;color:#fff;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;overflow:hidden;-webkit-font-smoothing:antialiased}
  /* Intro (tap orange) */
  #intro{position:fixed;inset:0;background:#000;display:grid;place-items:center;z-index:9999;opacity:1;pointer-events:auto;transition:opacity 900ms ease}
  #intro.hidden{opacity:0;pointer-events:none}
  .intro-stack{display:grid;justify-items:center;gap:1rem}
  #startOrange{font-size:clamp(110px,30vw,240px);line-height:1;cursor:pointer;filter:drop-shadow(0 0 26px rgba(0,0,0,.65)) drop-shadow(0 0 50px rgba(255,165,0,.25));transition:transform .12s ease}
  #startOrange:active{transform:scale(.98)}
  .intro-title{font-weight:900;letter-spacing:.14em;font-size:clamp(18px,6.2vw,44px);color:var(--bergamot);
    text-shadow:0 0 10px rgba(255,166,77,.55),0 0 22px rgba(255,165,0,.35);animation:titlePulse 2.2s ease-in-out infinite}
  @keyframes titlePulse{0%{color:var(--bergamot)}50%{color:var(--pure)}100%{color:var(--bergamot)}}
  /* Stage + background */
  #phone{position:fixed;inset:0;display:grid;place-items:center}
  #canvas{position:relative;width:100%;height:100%;overflow:hidden;background:#000}
  #brandBar{position:absolute;left:0;right:0;top:10px;display:flex;justify-content:center;z-index:6;filter:drop-shadow(var(--glow))}
  #brand{font-weight:900;letter-spacing:.12em;font-size:clamp(18px,5vw,32px);color:#FFA500}
  #bgLayer{position:absolute;inset:0;z-index:1}
  #bgVideo{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;opacity:0;transition:opacity .4s ease}
  .fogWrap{position:absolute;inset:-30%;pointer-events:none; -webkit-mask-image:radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 62%, rgba(0,0,0,0) 100%); mask-image:radial-gradient(circle at 50% 50%, rgba(0,0,0,1) 62%, rgba(0,0,0,0) 100%)}
  .fog{position:absolute;inset:0;mix-blend-mode:screen;filter:blur(60px) saturate(120%);
    background:radial-gradient(28% 22% at 20% 30%, var(--nick) 0 55%, transparent 60%),
               radial-gradient(28% 24% at 80% 40%, var(--nick) 0 55%, transparent 60%),
               radial-gradient(30% 22% at 40% 70%, var(--nick) 0 55%, transparent 60%);
    animation:fog1 26s linear infinite alternate; opacity:.62}
  @keyframes fog1{0%{transform:translate(0,0) scale(1)}100%{transform:translate(-3%,-4%) scale(1.08)}}
  #focus{position:absolute;inset:0;display:grid;place-items:center;z-index:2}
  .wrapCenter{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%) scale(1)}
  .preGrow{transform:translate(-50%,-50%) scale(.05);opacity:0}
  .grow{animation:ringGrow var(--growDur,3600ms) cubic-bezier(.17,.9,.24,1.08) forwards;opacity:0}
  #innerWrap.grow {--growDur:3600ms} #midWrap.grow{--growDur:4200ms;animation-delay:200ms} #outerWrap.grow{--growDur:4600ms;animation-delay:350ms}
  @keyframes ringGrow{0%{transform:translate(-50%,-50%) scale(.05) rotate(0deg);opacity:0}60%{transform:translate(-50%,-50%) scale(1.10) rotate(45deg);opacity:1}100%{transform:translate(-50%,-50%) scale(1.00) rotate(0deg);opacity:1}}
  .spin{position:absolute;inset:0}
  .halo{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);border-radius:50%;background:radial-gradient(closest-side, rgba(0,0,0,.35), rgba(0,0,0,0));filter:blur(10px);pointer-events:none;z-index:-1}
  /* Center prompt */
  #question{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);display:grid;place-items:center;border-radius:50%;filter:drop-shadow(var(--glow));padding:.4rem .6rem;animation:breathe 7s ease-in-out infinite}
  #questionText{font-weight:900;font-style:italic;text-align:center;font-size:clamp(16px,3.6vw,22px);line-height:1.15;margin:0;animation:colorPulse 5.5s ease-in-out infinite}
  @keyframes breathe{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.02)}}
  @keyframes colorPulse{0%{color:#fff}33%{color:var(--bergamot)}66%{color:#FFA500}100%{color:#fff}}

  /* Rings */
  #innerSVG,#outerSVG{transform-box:fill-box;transform-origin:50% 50%;animation:spinCW 60s linear infinite}
  #outerSVG{animation-duration:70s}
  @keyframes spinCW{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
  .ghost-wedge{fill:var(--c0);animation:ghostFlick var(--dur,12s) ease-in-out infinite;animation-delay:var(--delay,0s);cursor:pointer}
  @keyframes ghostFlick{0%,88%,100%{fill:var(--c0)}89%,90%{fill:var(--c1)}}

  /* Painting ring */
  #midWrap{z-index:8}
  #midSpin{animation:spinCCW 56s linear infinite;filter:drop-shadow(var(--glow))}
  @keyframes spinCCW{from{transform:rotate(0deg)}to{transform:rotate(-360deg)}}
  #midRing{position:absolute;inset:0}
  .mnode{position:absolute;top:50%;left:50%;border-radius:50%;transform:translate(-50%,-50%);background:#111;overflow:hidden;border:1.5px solid #000;filter:drop-shadow(var(--glow));cursor:pointer}
  .mnode.withCloud::before{content:"";position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:calc(100% + 16px);height:calc(100% + 16px);border-radius:inherit;background:radial-gradient(closest-side, rgba(0,0,0,.38), rgba(0,0,0,0));filter:blur(8px);pointer-events:none}
  .mnode img{width:100%;height:100%;object-fit:cover;display:block;border-radius:50%;transform-origin:center;backface-visibility:hidden}
  /* Bottom nav */
  .bottomNav{position:fixed;left:0;right:0;bottom:calc(env(safe-area-inset-bottom) + 10px);z-index:8;display:flex;gap:10px;justify-content:space-between;padding:0 12px}
  .navBtn{flex:1;text-align:center;font-weight:900;padding:10px 8px;border-radius:12px;border:1px solid rgba(0,0,0,.45);color:#140a00;user-select:none;cursor:pointer;box-shadow:0 6px 18px rgba(0,0,0,.35);text-decoration:none;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:clamp(12px,3.2vw,14px);line-height:1.05}
  .navLeft{background:linear-gradient(180deg,#F4C430,#E69B20)}
  .navMid{background:linear-gradient(180deg,#FF8E00,#FF6A13)}
  .navRight{background:linear-gradient(180deg,#FFA500,#FE5000)}

  /* Transition overlay */
  #transition{position:fixed;inset:0;background:#000;z-index:10050;display:grid;place-items:center;opacity:0;pointer-events:none;transition:opacity 600ms ease}
  #transition.show{opacity:1;pointer-events:auto}
  #quoteBox{max-width:min(92vw,720px);padding:2.2rem 1.6rem;text-align:center}
  #quoteText{font-weight:900;font-style:italic;letter-spacing:.02em;font-size:clamp(18px,5.2vw,30px);line-height:1.25;color:#ddd;text-shadow:0 0 10px rgba(0,0,0,.8)}
  .Oword{animation:orangeHue 2.8s ease-in-out infinite alternate, orangeGlow 2.8s ease-in-out infinite alternate}
  @keyframes orangeHue{0%{color:var(--nick)}100%{color:var(--after)}}
  @keyframes orangeGlow{0%{text-shadow:0 0 10px rgba(255,166,77,.55),0 0 18px rgba(255,102,0,.35)}100%{text-shadow:0 0 12px rgba(255,166,77,.75),0 0 26px rgba(255,102,0,.55)}}

  /* üîá Audio player UI is intentionally INVISIBLE */
  .audio-ui{display:none !important}
</style>
</head>
<body>

<!-- Intro -->
<div id="intro">
  <div class="intro-stack">
    <div id="startOrange" aria-label="Start">üçä</div>
    <div class="intro-title">neurOrange</div>
  </div>
</div>

<div id="phone">
  <div id="canvas">
    <div id="brandBar"><div id="brand">neurOrange</div></div>

    <div id="bgLayer">
      <video id="bgVideo" muted playsinline preload="auto" loop>
        <source src="assets/placeholder.mp4" type="video/mp4" />
      </video>
      <div class="fogWrap"><div class="fog"></div></div>
    </div>

    <div id="focus">
      <!-- outer/internal rings + paintings -->
      <div id="outerWrap" class="wrapCenter preGrow"><svg id="outerSVG" width="0" height="0" viewBox="0 0 1000 1000" style="position:absolute;inset:0"></svg><div class="halo"></div></div>
      <div id="innerWrap" class="wrapCenter preGrow"><svg id="innerSVG" width="0" height="0" viewBox="0 0 1000 1000" style="position:absolute;inset:0"></svg><div class="halo"></div></div>
      <div id="midWrap"   class="wrapCenter preGrow"><div id="midSpin" class="spin"><div id="midRing"></div></div></div>

      <!-- center prompt -->
      <div id="question"><div id="questionText">What are you<br/>feeling?</div></div>
    </div>

    <!-- Bottom nav -->
    <div class="bottomNav">
      <a class="navBtn navLeft"  href="https://vahetharoutounian-stack.github.io/neurOrangeV3/">Color Library</a>
      <a class="navBtn navMid"   href="https://vahetharoutounian-stack.github.io/neurOrangeV2/">Art Gallery</a>
      <a class="navBtn navRight" href="https://vahetharoutounian-stack.github.io/neurOrangeV3/#step=3">Illusion Lab</a>
    </div>
  </div>
</div>

<!-- Transition overlay -->
<div id="transition"><div id="quoteBox"><div id="quoteText"></div></div></div>

<!-- üîà Hidden audio engine (no visible controls) -->
<div class="audio-ui" aria-hidden="true">
  <audio id="a_sparkle" loop preload="metadata" playsinline>
    <source src="tracks/sparkle.mp3" type="audio/mpeg" />
    <source src="tracks/sparkle.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_orange" loop preload="metadata" playsinline>
    <source src="tracks/orange.mp3" type="audio/mpeg" />
    <source src="tracks/orange.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_autumn" loop preload="metadata" playsinline>
    <source src="tracks/autumn.mp3" type="audio/mpeg" />
    <source src="tracks/autumn.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_storm" loop preload="metadata" playsinline>
    <source src="tracks/storm.mp3" type="audio/mpeg" />
    <source src="tracks/storm.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_negin" loop preload="metadata" playsinline>
    <source src="tracks/negin.mp3" type="audio/mpeg" />
    <source src="tracks/negin.m4a" type="audio/mp4" />
  </audio>
</div>

<script>
/* ===== miniature helpers ===== */
function $(id){return document.getElementById(id)}
function hexNorm(h){return (h||'').replace(/^#/,'').toUpperCase()}

/* ===== quotes for transition ===== */
const QUOTES_RAW = [
  "‚ÄúIt‚Äôs funny how the colors of the real world only seem really real when you viddy them on the screen.‚Äù ‚Äî A Clockwork Orange (1971)",
  "‚ÄúOrange is the happiest color.‚Äù ‚Äî Frank Sinatra",
  "‚ÄúThere is no blue without yellow and without orange.‚Äù ‚Äî Vincent Van Gogh",
  "‚ÄúThe orange tree took time to create this masterpiece.‚Äù ‚Äî Thich Nhat Hanh",
  "‚ÄúIf the real world is orange juice, then art is like orange juice concentrate.‚Äù ‚Äî Martin Mull",
  "‚ÄúIn a world full of yellows and reds, dare to be orange.‚Äù"
];
function decorateOrangeWords(str){ return str.replace(/orange/gi, m => `<span class="Oword">${m}</span>`); }
function pickQuoteHTML(){ const i = (crypto?.getRandomValues ? crypto.getRandomValues(new Uint32Array(1))[0] : Math.floor(Math.random()*1e9)) % QUOTES_RAW.length; return decorateOrangeWords(QUOTES_RAW[i]); }

/* ===== rings drawing (trimmed core) ===== */
function wedgePath(cx,cy,r0,r1,a0Deg,a1Deg){
  const R=d=>d*Math.PI/180; const a0=R(a0Deg),a1=R(a1Deg);
  const P=(r,a)=>({x:cx+r*Math.cos(a),y:cy+r*Math.sin(a)}); const A=P(r1,a0),B=P(r1,a1),C=P(r0,a1),D=P(r0,a0);
  const large=(a1Deg-a0Deg)>180?1:0; return `M ${D.x} ${D.y} L ${A.x} ${A.y} A ${r1} ${r1} 0 ${large} 1 ${B.x} ${B.y} L ${C.x} ${C.y} A ${r0} ${r0} 0 ${large} 0 ${D.x} ${D.y} Z`;
}
function drawRing(svgEl,sizePx,r0px,r1px,colors,gapDeg,onClickHex){
  svgEl.setAttribute('viewBox','0 0 1000 1000'); svgEl.style.width=sizePx+'px'; svgEl.style.height=sizePx+'px';
  const k=1000/sizePx, r0=Math.max(2,r0px*k), r1=r1px*k, gap=Number(gapDeg)||0;
  const n=colors.length, slice=360/n; svgEl.innerHTML='';
  for(let i=0;i<n;i++){
    const hex=colors[i]; const a0=i*slice, a1=(i+1)*slice-gap;
    const p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',wedgePath(500,500,r0,r1,a0,a1)); p.setAttribute('fill',hex);
    p.setAttribute('stroke','rgba(0,0,0,.18)'); p.setAttribute('stroke-width','1');
    if(onClickHex) p.addEventListener('click',()=>onClickHex(hex),{passive:true});
    svgEl.appendChild(p);
  }
}
function drawGhostRing(svgEl,sizePx,r0px,r1px,ghostHexes,gapDeg){
  svgEl.setAttribute('viewBox','0 0 1000 1000'); svgEl.style.width=sizePx+'px'; svgEl.style.height=sizePx+'px';
  const k=1000/sizePx, r0=Math.max(2,r0px*k), r1=r1px*k, gap=Number(gapDeg)||0;
  const n=ghostHexes.length, slice=360/n; svgEl.innerHTML='';
  for(let i=0;i<n;i++){
    const base=ghostHexes[i]; const opp = opponent(base);
    const a0=i*slice, a1=(i+1)*slice-gap;
    const p=document.createElementNS('http://www.w3.org/2000/svg','path');
    p.setAttribute('d',wedgePath(500,500,r0,r1,a0,a1));
    p.classList.add('ghost-wedge'); p.style.setProperty('--c0',base); p.style.setProperty('--c1',opp);
    const dur=10+Math.random()*6, phase=Math.random()*dur;
    p.style.setProperty('--dur',dur.toFixed(2)+'s'); p.style.setProperty('--delay',(-phase).toFixed(2)+'s');
    p.setAttribute('stroke','rgba(0,0,0,.18)'); p.setAttribute('stroke-width','1');
    p.addEventListener('click',()=>transitionTo(`https://vahetharoutounian-stack.github.io/neurOrangeV3/#step=3&cat=ghosts&hex=${base.replace('#','').toUpperCase()}`),{passive:true});
    svgEl.appendChild(p);
  }
}
function opponent(hex){hex=hex.replace('#','');if(hex.length===3)hex=hex.split('').map(c=>c+c).join('');const r=parseInt(hex.slice(0,2),16),g=parseInt(hex.slice(2,4),16),b=parseInt(hex.slice(4,6),16);const {h,s,l}=rgbToHsl(r,g,b);const opp=(h+180)%360;const {r:R,g:G,b:B}=hslToRgb(opp,s,l);return '#'+[R,G,B].map(v=>v.toString(16).padStart(2,'0')).join('')}
function rgbToHsl(r,g,b){r/=255;g/=255;b/=255;const mx=Math.max(r,g,b),mn=Math.min(r,g,b);let h,s,l=(mx+mn)/2;if(mx===mn){h=s=0}else{const d=mx-mn;s=l>0.5?d/(2-mx-mn):d/(mx+mn);switch(mx){case r:h=(g-b)/d+(g<b?6:0);break;case g:h=(b-r)/d+2;break;case b:h=(r-g)/d+4;break}h/=6}return {h:h*360,s,l}}
function hslToRgb(h,s,l){h/=360;let r,g,b;if(s===0){r=g=b=l}else{const hue2rgb=(p,q,t)=>{if(t<0)t+=1;if(t>1)t-=1;if(t<1/6)return p+(q-p)*6*t;if(t<1/2)return q;if(t<2/3)return p+(q-p)*(2/3-t)*6;return p};const q=l<0.5?l*(1+s):l+s-l*s,p=2*l-q;r=hue2rgb(p,q,h+1/3);g=hue2rgb(p,q,h);b=hue2rgb(p,q,h-1/3)}return {r:Math.round(r*255),g:Math.round(g*255),b:Math.round(b*255)}}

/* ===== layout rings ===== */
const BRIGHT=["#FE5000","#FFA500","#FF8E00","#FF6600","#FF6A00","#FF9400","#F28500","#FF7F24","#ED9121","#FFBF00","#FF5E00","#FF6A13"];
const GHOSTS=["#B36019","#F9751F","#F6B76F","#D2B379","#E3AC47","#F88E10","#C18514","#DE9513","#92752D","#F0CE85","#FCBA45","#D99621","#E8C569","#F0B85F","#D2B265"];

function layoutRings(){
  const innerSVG=$('innerSVG'), outerSVG=$('outerSVG'), innerWrap=$('innerWrap'), outerWrap=$('outerWrap'), midRing=$('midRing');
  const W=innerWidth, H=innerHeight, S=Math.min(W,H);
  document.documentElement.style.setProperty('--emoji-font',Math.round(W*0.036)+'px');

  const innerD=Math.round(S*0.58), innerThick=Math.max(16,Math.round(innerD*0.12));
  innerWrap.style.width=innerD+'px'; innerWrap.style.height=innerD+'px';
  const innerOuter=innerD/2, innerInner=Math.max(2, innerOuter-innerThick*2);
  drawRing(innerSVG, innerD, innerInner, innerOuter, BRIGHT, getComputedStyle(document.documentElement).getPropertyValue('--gap-deg')||3,
    (hex)=>transitionTo(`https://vahetharoutounian-stack.github.io/neurOrangeV3/#step=2&cat=standards&hex=${hexNorm(hex)}`));

  /* paintings ring */
  const nodeD=Math.round(innerThick*0.85*5.25*0.82), margin=2, midR=Math.max(0,(W/2)-(nodeD/2)-margin);
  const N=6, step=2*Math.PI/N;
  if(!midRing.children.length){
    for(let i=1;i<=6;i++){
      const n=document.createElement('div'); n.className='mnode withCloud';
      n.addEventListener('click',()=>transitionTo(`https://vahetharoutounian-stack.github.io/neurOrangeV2/#painting=${i}`),{passive:true});
      const img=new Image(); img.alt='Painting '+i; img.src=`assets/paintings/${i}.jpg`; n.appendChild(img);
      midRing.appendChild(n);
    }
  }
  Array.from(midRing.children).forEach((n,i)=>{const a=i*step, x=Math.cos(a)*midR, y=Math.sin(a)*midR;
    n.style.width=nodeD+'px'; n.style.height=nodeD+'px';
    n.style.transform=`translate(calc(-50% + ${x}px), calc(-50% + ${y}px))`;});

  /* ghost outer ring */
  const outerInnerR=midR + nodeD/2 + margin;
  const outerThick  = innerThick * (parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--outer-thick-mult'))||2.2);
  const outerOuterR = Math.max(outerInnerR + outerThick, W/2 + 8);
  const outD = Math.round(outerOuterR*2);
  outerWrap.style.width=outD+'px'; outerWrap.style.height=outD+'px';
  drawGhostRing(outerSVG, outD, outerInnerR, outerOuterR, GHOSTS, getComputedStyle(document.documentElement).getPropertyValue('--gap-deg')||3);
}

/* ===== transition + quotes ===== */
let transitioning=false;
function transitionTo(url){
  if(transitioning) return; transitioning=true;
  const tr=$('transition'), qt=$('quoteText'); qt.innerHTML = pickQuoteHTML();
  tr.classList.add('show'); setTimeout(()=>{ location.href=url; }, 2200);
}
window.addEventListener('pageshow', ()=>{ $('transition').classList.remove('show'); transitioning=false; });

/* ===== audio engine (hidden) ===== */
const A = {
  sparkle: $('a_sparkle'),
  orange : $('a_orange'),
  autumn : $('a_autumn'),
  storm  : $('a_storm'),
  negin  : $('a_negin')
};
const boosts = { sparkle: 0.9, storm: 0.9, orange: 1.0, autumn: 1.0, negin: 1.0 };
Object.entries(A).forEach(([k,a])=>{ if(a){ a.loop = true; a.preload = 'auto'; a.volume = Math.min(1, (boosts[k]||1)); }});

/* Unlock + start on the üçä tap */
$('startOrange').addEventListener('click', async () => {
  // fade intro
  const intro=$('intro'); intro.classList.add('hidden');

  // reveal/auto-play background video
  const v=$('bgVideo'); if(v){ const show=()=>v.style.opacity=1; v.addEventListener('loadeddata',show,{once:true}); v.addEventListener('playing',show,{once:true}); v.play().catch(()=>{}); }

  // ring grow-out
  ['innerWrap','midWrap','outerWrap'].forEach(id=>{
    const el=$(id); el.classList.remove('grow'); el.classList.add('preGrow'); requestAnimationFrame(()=> el.classList.add('grow'));
  });

  // iOS-safe audio unlock tied to this user gesture
  try{
    const list = Object.values(A).filter(Boolean);
    for(const a of list){ a.muted = true; a.volume = 0; try{ await a.play(); }catch{} }
    await new Promise(r=>setTimeout(r,80));
    for(const a of list){ try{ a.pause(); a.currentTime = 0; }catch{} a.muted = false; }
  }catch{}

  // start the sparkle bed (you can add others here)
  A.sparkle && A.sparkle.play().catch(()=>{ /* if missing, fail quietly */ });
}, {passive:true});

/* ===== initialize ===== */
layoutRings();
</script>
</body>
</html>
