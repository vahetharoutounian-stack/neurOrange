<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>Nickelodeon Audio Player</title>
<style>
  :root {
    --nick: #FF6600;
    --nick2: #FF3B00;
    --berg-a: #ffeca7;
    --berg-b: #ffd45c;
  }
  html, body { height: 100%; margin: 0; }
  /* Transparent so your site‚Äôs background/video shows (Safari included) */
  body { background: transparent; color:#fff; font:15px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; }

  /* Tray anchored bottom-left, scaled to 50% */
  #dock {
    position: fixed;
    left: calc(12px + env(safe-area-inset-left));
    bottom: calc(12px + env(safe-area-inset-bottom));
    z-index: 2147483647;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 14px;
    border-radius: 999px;
    background: linear-gradient(135deg, var(--nick), var(--nick2));
    color: #fff;
    border: 1px solid rgba(0,0,0,0.35);
    box-shadow: 0 8px 20px rgba(255,102,0,0.32);
    -webkit-user-select: none;
    user-select: none;
    transform: scale(.5);
    transform-origin: left bottom;
  }
  #dock.collapsed .hideable { display: none !important; }

  /* Round ‚Äòtoggle‚Äô bubble */
  .bubble {
    position: relative; width: 46px; height: 46px; border: none; background: transparent; cursor: pointer; padding: 0; outline: none;
  }
  .bubble::before {
    content: ""; position: absolute; inset: -2px; border-radius: 999px;
    background: linear-gradient(135deg, var(--nick), var(--nick2)); box-shadow: 0 6px 16px rgba(0,0,0,0.35);
  }
  .bubble .inner {
    position: absolute; inset: 5px; border-radius: 999px;
    background: radial-gradient(60% 60% at 35% 25%, #fff6c2 0%, var(--berg-a) 40%, var(--berg-b) 100%);
  }
  .bubble .glyph { position: relative; z-index: 2; font-size: 22px; line-height: 46px; display: block; text-align: center; }

  /* Track orbs + stop */
  .orb {
    width: 42px; height: 42px; border-radius: 999px;
    display: grid; place-items: center;
    font-size: 20px; font-weight: 900;
    background: rgba(0,0,0,0.18);
    border: 1px solid rgba(0,0,0,0.35);
    cursor: pointer; position: relative;
    transition: opacity .18s ease;
  }
  .glyph { pointer-events: none; }

  /* Volume popover ‚Äî always centered above its button, with high z-index */
  .ad-wrap { position: relative; }
  .ad-vol {
    position: absolute;
    bottom: 58px;
    left: 50%;
    transform: translateX(-50%);
    width: 44px;
    padding: 8px 6px;
    border-radius: 12px;
    background: rgba(22,22,22,.92);
    border: 1px solid rgba(255,255,255,.2);
    box-shadow: 0 10px 24px rgba(0,0,0,.45);
    display: none;
    z-index: 1000;
  }
  .ad-vol.visible { display: block; }
  .ad-vol label {
    color: #fff; font-size: 11px; opacity: .8; text-align: center; margin-bottom: 6px; display: block;
  }
  .ad-vol input[type="range"] {
    writing-mode: bt-lr; -webkit-appearance: slider-vertical;
    width: 30px; height: 110px; background: transparent; padding: 0; margin: 0 auto;
  }
  .ad-vol input[type="range"]::-webkit-slider-thumb{
    -webkit-appearance: none; width: 18px; height: 18px; border-radius: 50%;
    background: #FF6600; border: 1px solid rgba(0,0,0,.35); box-shadow: 0 1px 4px rgba(0,0,0,.35);
  }
  .ad-vol input[type="range"]::-webkit-slider-runnable-track{
    width: 6px; background: #ddd; border-radius: 999px; border: 0;
  }
  .ad-vol input[type="range"]::-moz-range-thumb{
    width: 18px; height: 18px; border-radius: 50%;
    background: #FF6600; border: 1px solid rgba(0,0,0,.35);
  }
  .ad-vol input[type="range"]::-moz-range-track{
    width: 6px; background: #ddd; border-radius: 999px; border: 0;
  }

  /* kill any legacy big overlay if present */
  #startOverlay { display: none !important; }
</style>
</head>
<body>

  <!-- AUDIO: (‚àí25% base volume applied in JS) -->
  <audio id="a_sparkle" loop preload="metadata" playsinline>
    <source src="tracks/sparkle.mp3" type="audio/mpeg" />
    <source src="tracks/sparkle.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_orange" loop preload="metadata" playsinline>
    <source src="tracks/orange.mp3" type="audio/mpeg" />
    <source src="tracks/orange.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_autumn" loop preload="metadata" playsinline>
    <source src="tracks/autumn.mp3" type="audio/mpeg" />
    <source src="tracks/autumn.m4a" type="audio/mp4" />
  </audio>
  <audio id="a_storm" loop preload="metadata" playsinline>
    <source src="tracks/storm.mp3" type="audio/mpeg" />
    <source src="tracks/storm.m4a" type="audio/mp4" />
  </audio>

  <!-- DOCK: shrunk to 50%, sliders now centered above their emojis -->
  <div id="dock" class="collapsed" role="group" aria-label="Audio controls">
    <!-- Toggle -->
    <button id="b_toggle" class="bubble" aria-label="Toggle">
      <span class="inner"></span><span class="glyph">üü°</span>
    </button>

    <!-- Stop: orange square emoji (üüß), per request -->
    <button id="b_stop" class="orb" aria-label="Stop / Reset"><span class="glyph">üüß</span></button>

    <!-- Sparkle -->
    <div class="hideable ad-wrap">
      <button id="b_sparkle" class="orb" aria-label="Sparkle"><span class="glyph">üå±</span></button>
      <div class="ad-vol" data-for="sparkle"><label>‚ú®</label><input type="range" min="0" max="1" step="0.01" value="0.75"/></div>
    </div>

    <!-- Orange -->
    <div class="hideable ad-wrap">
      <button id="b_orangeTr" class="orb" aria-label="Orange"><span class="glyph">üå±</span></button>
      <div class="ad-vol" data-for="orange"><label>üçä</label><input type="range" min="0" max="1" step="0.01" value="0.75"/></div>
    </div>

    <!-- Autumn -->
    <div class="hideable ad-wrap">
      <button id="b_autumn" class="orb" aria-label="Autumn"><span class="glyph">üå±</span></button>
      <div class="ad-vol" data-for="autumn"><label>üçÇ</label><input type="range" min="0" max="1" step="0.01" value="0.75"/></div>
    </div>

    <!-- Storm -->
    <div class="hideable ad-wrap">
      <button id="b_storm" class="orb" aria-label="Storm"><span class="glyph">üå±</span></button>
      <div class="ad-vol" data-for="storm"><label>‚õàÔ∏è</label><input type="range" min="0" max="1" step="0.01" value="0.75"/></div>
    </div>

    <!-- NOTE: üí´ (negin) removed as requested -->
  </div>

<script>
(() => {
  const dock      = document.getElementById('dock');
  const btnToggle = document.getElementById('b_toggle');
  const btnStop   = document.getElementById('b_stop');

  /* Safari-friendly list: no üí´/negin; overall gain -25% */
  const tracks = [
    { id:'sparkle', emoji:'‚ú®', a:document.getElementById('a_sparkle'), b:document.getElementById('b_sparkle'), vol:document.querySelector('.ad-vol[data-for="sparkle"]'), exclusive:true },
    { id:'orange',  emoji:'üçä', a:document.getElementById('a_orange'),  b:document.getElementById('b_orangeTr'), vol:document.querySelector('.ad-vol[data-for="orange"]'),  exclusive:true },
    { id:'autumn',  emoji:'üçÇ', a:document.getElementById('a_autumn'),  b:document.getElementById('b_autumn'),  vol:document.querySelector('.ad-vol[data-for="autumn"]'),  exclusive:true },
    { id:'storm',   emoji:'‚õàÔ∏è', a:document.getElementById('a_storm'),   b:document.getElementById('b_storm'),   vol:document.querySelector('.ad-vol[data-for="storm"]'),   exclusive:false }
  ];

  const BASE = 0.75; /* 75% base volume (‚àí25%) */
  const BOOST = { sparkle:1.6, storm:2.2, orange:1.0, autumn:1.0 };

  function setGlyph(btn, symbol){ const g=btn.querySelector('.glyph'); if(g) g.textContent = symbol; }

  function hideAllVols(){ document.querySelectorAll('.ad-vol.visible').forEach(el=>el.classList.remove('visible')); }

  function applyVolume(t, fromSlider=false){
    const slider = t.vol?.querySelector('input[type="range"]');
    let v = slider ? parseFloat(slider.value||BASE) : BASE;
    v = Math.min(1, v * (BOOST[t.id] || 1)); /* safe cap */
    t.a.volume = v;
    if (!fromSlider && slider) slider.value = t.a.volume;
  }

  async function start(t, showSlider=true){
    if (t.exclusive){
      tracks.forEach(x => { if (x!==t && x.exclusive && !x.a.paused) stop(x); });
    }
    /* Safari: ensure currentTime set only after metadata is available */
    try { t.a.currentTime = 0; } catch(_) {}
    applyVolume(t);
    try {
      await t.a.play();
      setGlyph(t.b, t.emoji);            /* flip to emoji when playing */
      if (showSlider && t.vol){
        hideAllVols();
        t.vol.classList.add('visible');  /* CSS centers it above the button */
      }
    } catch(e) {
      /* Autoplay blocked or not unlocked yet ‚Äî keep sprout */
      setGlyph(t.b, 'üå±');
    }
  }

  function stop(t){
    try { t.a.pause(); } catch(_) {}
    setGlyph(t.b, 'üå±');                 /* revert to sprout when stopped */
    if (t.vol) t.vol.classList.remove('visible');
  }

  /* Wire buttons + sliders */
  tracks.forEach(t => {
    t.b.addEventListener('click', () => {
      if (t.a.paused) start(t, true);
      else stop(t);
    }, {passive:true});

    const slider = t.vol?.querySelector('input[type="range"]');
    if (slider){
      applyVolume(t, true); /* init */
      slider.addEventListener('input', () => applyVolume(t, true), {passive:true});
    }

    /* Keep glyphs accurate if user stops audio externally */
    t.a.addEventListener('ended', () => setGlyph(t.b,'üå±'));
    t.a.addEventListener('pause', () => { if (!t.a.ended) setGlyph(t.b,'üå±'); });
  });

  /* Collapse/expand tray */
  btnToggle.addEventListener('click', () => {
    dock.classList.toggle('collapsed');
    if (!dock.classList.contains('collapsed')) hideAllVols();
  }, {passive:true});

  /* Stop all (üüß remains as glyph) */
  btnStop.addEventListener('click', () => {
    tracks.forEach(stop);
    dock.classList.add('collapsed');
  }, {passive:true});

  /* Use the FRONT PAGE neurOrange emoji to start player in Safari */
  const startOrange = document.getElementById('startOrange');
  if (startOrange){
    startOrange.addEventListener('click', () => {
      dock.classList.remove('collapsed');
      const sparkle = tracks.find(x=>x.id==='sparkle');
      start(sparkle, false);
    }, {once:true, passive:true});
  }

  /* iOS unlock fallback (first touch primes audio) */
  function unlock(){
    window.removeEventListener('pointerdown', unlock, true);
    tracks.forEach(t => { try { const p=t.a.play(); p&&p.then(()=>{t.a.pause(); t.a.currentTime=0;}).catch(()=>{});} catch(_){} });
  }
  window.addEventListener('pointerdown', unlock, {once:true, capture:true, passive:true});

  /* Nothing to compute for slider X ‚Äî CSS centers it above the button.
     Ensure it stays above after resize. */
  window.addEventListener('resize', () => {
    /* no-op: CSS handles centering; we just close open sliders if collapsed */
    if (dock.classList.contains('collapsed')) hideAllVols();
  }, {passive:true});
})();
</script>
</body>
</html>
